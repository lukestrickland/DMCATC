---
title: "Parameter and Posterior Inference Tables for ATC Experiment E1"
author: "Russell Boag"
date: "12 July 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load and prep data, echo=FALSE, include=FALSE}


rm(list=ls())
setwd("C:/Users/Russell Boag/Documents/GitHub/DMCATC")
source("dmc/dmc.R")
source("dmc/dmc_ATC.R")
load_model ("LBA","lbaN_B.R")
# source("LSAnova.R")
require("gridExtra")
require("lme4")
require("car")
pkgs <- c("plyr", "dplyr", "tidyr", "broom", "pander", "xtable")
sapply(pkgs, require, character.only = T) #load

# # # Load samples object # # #
#
load("data/samples/E1.block.B.V_cond.B.V.PMV.samples.RData")  # Samples object
samples.E1 <- E1.block.B.V_cond.B.V.PMV.samples
rm(E1.block.B.V_cond.B.V.PMV.samples)

samples.E1 <- samples.E1[names(samples.E1) != "p17"]  # Exclude p17 E1 due to no PM responses



# # # Load functions # # #
#
group.inference.dist <- function (hsamples, fun) {
  inference <- list()
  for (i in 1:length(hsamples)) {
   thetas <- hsamples[[i]]$theta
   inference [[i]] <- fun (thetas)
  }
   inf2 <- unlist(inference)
   dim3 <- c(dim(inference[[1]]), length(inf2)/prod(dim(inference[[1]])))
   dim(inf2) <- dim3
   apply(inf2, c(1,2,3), mean)
}

minp <- function (effect) min(ecdf(effect)(0), 1-ecdf(effect)(0))

zandp <- function(samples, fun){
    effect<- group.inference.dist(samples, fun)
    Z <- mean(effect)/sd(effect)
    p <- minp(effect)
    paste(round(Z,2), "(", round(p,3), ")", sep="")
}

mean.sd <- function(samples, fun){
    effect<- group.inference.dist(samples, fun)
    M <- mean(effect)
    SD <- sd(effect)
    data.frame(M, SD)
}

# # # Reactive Control # # #
#
Reactive.ccAC <- function (thetas) thetas[,"mean_v.ccA3C",, drop=F] - thetas[,"mean_v.pcA3C",, drop=F]
Reactive.ccBC <- function (thetas) thetas[,"mean_v.ccB3C",, drop=F] - thetas[,"mean_v.pcB3C",, drop=F]
Reactive.ccCC <- function (thetas) thetas[,"mean_v.ccC3C",, drop=F] - thetas[,"mean_v.pcC3C",, drop=F]
Reactive.ccDC <- function (thetas) thetas[,"mean_v.ccD3C",, drop=F] - thetas[,"mean_v.pcD3C",, drop=F]

Reactive.nnAN <- function (thetas) thetas[,"mean_v.nnA3N",, drop=F] - thetas[,"mean_v.pnA3N",, drop=F]
Reactive.nnBN <- function (thetas) thetas[,"mean_v.nnB3N",, drop=F] - thetas[,"mean_v.pnB3N",, drop=F]
Reactive.nnCN <- function (thetas) thetas[,"mean_v.nnC3N",, drop=F] - thetas[,"mean_v.pnC3N",, drop=F]
Reactive.nnDN <- function (thetas) thetas[,"mean_v.nnD3N",, drop=F] - thetas[,"mean_v.pnD3N",, drop=F]

Reactive.ccAN <- function (thetas) thetas[,"mean_v.ccA3N",, drop=F] - thetas[,"mean_v.pcA3N",, drop=F]
Reactive.ccBN <- function (thetas) thetas[,"mean_v.ccB3N",, drop=F] - thetas[,"mean_v.pcB3N",, drop=F]
Reactive.ccCN <- function (thetas) thetas[,"mean_v.ccC3N",, drop=F] - thetas[,"mean_v.pcC3N",, drop=F]
Reactive.ccDN <- function (thetas) thetas[,"mean_v.ccD3N",, drop=F] - thetas[,"mean_v.pcD3N",, drop=F]

Reactive.nnAC <- function (thetas) thetas[,"mean_v.nnA3C",, drop=F] - thetas[,"mean_v.pnA3C",, drop=F]
Reactive.nnBC <- function (thetas) thetas[,"mean_v.nnB3C",, drop=F] - thetas[,"mean_v.pnB3C",, drop=F]
Reactive.nnCC <- function (thetas) thetas[,"mean_v.nnC3C",, drop=F] - thetas[,"mean_v.pnC3C",, drop=F]
Reactive.nnDC <- function (thetas) thetas[,"mean_v.nnD3C",, drop=F] - thetas[,"mean_v.pnD3C",, drop=F]


# # # Proactive Control # # #
#
Proactive.AC <- function (thetas) thetas[,"B.A3C",, drop=F] - thetas[,"B.A2C",, drop=F]
Proactive.BC <- function (thetas) thetas[,"B.B3C",, drop=F] - thetas[,"B.B2C",, drop=F]
Proactive.CC <- function (thetas) thetas[,"B.C3C",, drop=F] - thetas[,"B.C2C",, drop=F]
Proactive.DC <- function (thetas) thetas[,"B.D3C",, drop=F] - thetas[,"B.D2C",, drop=F]

Proactive.AN <- function (thetas) thetas[,"B.A3N",, drop=F] - thetas[,"B.A2N",, drop=F]
Proactive.BN <- function (thetas) thetas[,"B.B3N",, drop=F] - thetas[,"B.B2N",, drop=F]
Proactive.CN <- function (thetas) thetas[,"B.C3N",, drop=F] - thetas[,"B.C2N",, drop=F]
Proactive.DN <- function (thetas) thetas[,"B.D3N",, drop=F] - thetas[,"B.D2N",, drop=F]


# # # Capacity (Difference in Drift between Control and PM blocks) # # #
#
Capacity.ccAC <- function (thetas) thetas[,"mean_v.ccA3C",, drop=F] - thetas[,"mean_v.ccA2C",, drop=F]
Capacity.ccBC <- function (thetas) thetas[,"mean_v.ccB3C",, drop=F] - thetas[,"mean_v.ccB2C",, drop=F]
Capacity.ccCC <- function (thetas) thetas[,"mean_v.ccC3C",, drop=F] - thetas[,"mean_v.ccC2C",, drop=F]
Capacity.ccDC <- function (thetas) thetas[,"mean_v.ccD3C",, drop=F] - thetas[,"mean_v.ccD2C",, drop=F]

Capacity.nnAN <- function (thetas) thetas[,"mean_v.nnA3N",, drop=F] - thetas[,"mean_v.nnA2N",, drop=F]
Capacity.nnBN <- function (thetas) thetas[,"mean_v.nnB3N",, drop=F] - thetas[,"mean_v.nnB2N",, drop=F]
Capacity.nnCN <- function (thetas) thetas[,"mean_v.nnC3N",, drop=F] - thetas[,"mean_v.nnC2N",, drop=F]
Capacity.nnDN <- function (thetas) thetas[,"mean_v.nnD3N",, drop=F] - thetas[,"mean_v.nnD2N",, drop=F]

Capacity.ccAN <- function (thetas) thetas[,"mean_v.ccA3N",, drop=F] - thetas[,"mean_v.ccA2N",, drop=F]
Capacity.ccBN <- function (thetas) thetas[,"mean_v.ccB3N",, drop=F] - thetas[,"mean_v.ccB2N",, drop=F]
Capacity.ccCN <- function (thetas) thetas[,"mean_v.ccC3N",, drop=F] - thetas[,"mean_v.ccC2N",, drop=F]
Capacity.ccDN <- function (thetas) thetas[,"mean_v.ccD3N",, drop=F] - thetas[,"mean_v.ccD2N",, drop=F]

Capacity.nnAC <- function (thetas) thetas[,"mean_v.nnA3C",, drop=F] - thetas[,"mean_v.nnA2C",, drop=F]
Capacity.nnBC <- function (thetas) thetas[,"mean_v.nnB3C",, drop=F] - thetas[,"mean_v.nnB2C",, drop=F]
Capacity.nnCC <- function (thetas) thetas[,"mean_v.nnC3C",, drop=F] - thetas[,"mean_v.nnC2C",, drop=F]
Capacity.nnDC <- function (thetas) thetas[,"mean_v.nnD3C",, drop=F] - thetas[,"mean_v.nnD2C",, drop=F]


# # # Proactive Control (PM Cost) by Time Pressure # # #
#
ProactiveTP.ABC <- function (thetas) (thetas[,"B.A3C",, drop=F] - thetas[,"B.A2C",, drop=F]) -
    (thetas[,"B.B3C",, drop=F] - thetas[,"B.B2C",, drop=F])
ProactiveTP.BCC <- function (thetas) (thetas[,"B.B3C",, drop=F] - thetas[,"B.B2C",, drop=F]) -
    (thetas[,"B.C3C",, drop=F] - thetas[,"B.C2C",, drop=F])
ProactiveTP.CDC <- function (thetas) (thetas[,"B.C3C",, drop=F] - thetas[,"B.C2C",, drop=F]) -
    (thetas[,"B.D3C",, drop=F] - thetas[,"B.D2C",, drop=F])

ProactiveTP.ABN <- function (thetas) (thetas[,"B.A3N",, drop=F] - thetas[,"B.A2N",, drop=F]) -
    (thetas[,"B.B3N",, drop=F] - thetas[,"B.B2N",, drop=F])
ProactiveTP.BCN <- function (thetas) (thetas[,"B.B3N",, drop=F] - thetas[,"B.B2N",, drop=F]) -
    (thetas[,"B.C3N",, drop=F] - thetas[,"B.C2N",, drop=F])
ProactiveTP.CDN <- function (thetas) (thetas[,"B.C3N",, drop=F] - thetas[,"B.C2N",, drop=F]) -
    (thetas[,"B.D3N",, drop=F] - thetas[,"B.D2N",, drop=F])


# # # Effort/Arousal by Time Pressure # # #
#
Effort.TPccCABC <- function (thetas) thetas[,"mean_v.ccA2C",, drop=F] - thetas[,"mean_v.ccB2C",, drop=F]
Effort.TPccCBCC <- function (thetas) thetas[,"mean_v.ccB2C",, drop=F] - thetas[,"mean_v.ccC2C",, drop=F]
Effort.TPccCCDC <- function (thetas) thetas[,"mean_v.ccC2C",, drop=F] - thetas[,"mean_v.ccD2C",, drop=F]

Effort.TPccPMABC <- function (thetas) thetas[,"mean_v.ccA3C",, drop=F] - thetas[,"mean_v.ccB3C",, drop=F]
Effort.TPccPMBCC <- function (thetas) thetas[,"mean_v.ccB3C",, drop=F] - thetas[,"mean_v.ccC3C",, drop=F]
Effort.TPccPMCDC <- function (thetas) thetas[,"mean_v.ccC3C",, drop=F] - thetas[,"mean_v.ccD3C",, drop=F]

Effort.TPnnCABN <- function (thetas) thetas[,"mean_v.nnA2N",, drop=F] - thetas[,"mean_v.nnB2N",, drop=F]
Effort.TPnnCBCN <- function (thetas) thetas[,"mean_v.nnB2N",, drop=F] - thetas[,"mean_v.nnC2N",, drop=F]
Effort.TPnnCCDN <- function (thetas) thetas[,"mean_v.nnC2N",, drop=F] - thetas[,"mean_v.nnD2N",, drop=F]

Effort.TPnnPMABN <- function (thetas) thetas[,"mean_v.nnA3N",, drop=F] - thetas[,"mean_v.nnB3N",, drop=F]
Effort.TPnnPMBCN <- function (thetas) thetas[,"mean_v.nnB3N",, drop=F] - thetas[,"mean_v.nnC3N",, drop=F]
Effort.TPnnPMCDN <- function (thetas) thetas[,"mean_v.nnC3N",, drop=F] - thetas[,"mean_v.nnD3N",, drop=F]


#
Effort.TPnnCABC <- function (thetas) thetas[,"mean_v.nnA2C",, drop=F] - thetas[,"mean_v.nnB2C",, drop=F]
Effort.TPnnCBCC <- function (thetas) thetas[,"mean_v.nnB2C",, drop=F] - thetas[,"mean_v.nnC2C",, drop=F]
Effort.TPnnCCDC <- function (thetas) thetas[,"mean_v.nnC2C",, drop=F] - thetas[,"mean_v.nnD2C",, drop=F]

Effort.TPnnPMABC <- function (thetas) thetas[,"mean_v.nnA3C",, drop=F] - thetas[,"mean_v.nnB3C",, drop=F]
Effort.TPnnPMBCC <- function (thetas) thetas[,"mean_v.nnB3C",, drop=F] - thetas[,"mean_v.nnC3C",, drop=F]
Effort.TPnnPMCDC <- function (thetas) thetas[,"mean_v.nnC3C",, drop=F] - thetas[,"mean_v.nnD3C",, drop=F]

Effort.TPccCABN <- function (thetas) thetas[,"mean_v.ccA2N",, drop=F] - thetas[,"mean_v.ccB2N",, drop=F]
Effort.TPccCBCN <- function (thetas) thetas[,"mean_v.ccB2N",, drop=F] - thetas[,"mean_v.ccC2N",, drop=F]
Effort.TPccCCDN <- function (thetas) thetas[,"mean_v.ccC2N",, drop=F] - thetas[,"mean_v.ccD2N",, drop=F]

Effort.TPccPMABN <- function (thetas) thetas[,"mean_v.ccA3N",, drop=F] - thetas[,"mean_v.ccB3N",, drop=F]
Effort.TPccPMBCN <- function (thetas) thetas[,"mean_v.ccB3N",, drop=F] - thetas[,"mean_v.ccC3N",, drop=F]
Effort.TPccPMCDN <- function (thetas) thetas[,"mean_v.ccC3N",, drop=F] - thetas[,"mean_v.ccD3N",, drop=F]

#
Effort.TPppPMABP <- function (thetas) thetas[,"mean_v.ppA3P",, drop=F] - thetas[,"mean_v.ppB3P",, drop=F]
Effort.TPppPMBCP <- function (thetas) thetas[,"mean_v.ppB3P",, drop=F] - thetas[,"mean_v.ppC3P",, drop=F]
Effort.TPppPMCDP <- function (thetas) thetas[,"mean_v.ppC3P",, drop=F] - thetas[,"mean_v.ppD3P",, drop=F]

Effort.TPpcPMABC <- function (thetas) thetas[,"mean_v.pcA3C",, drop=F] - thetas[,"mean_v.pcB3C",, drop=F]
Effort.TPpcPMBCC <- function (thetas) thetas[,"mean_v.pcB3C",, drop=F] - thetas[,"mean_v.pcC3C",, drop=F]
Effort.TPpcPMCDC <- function (thetas) thetas[,"mean_v.pcC3C",, drop=F] - thetas[,"mean_v.pcD3C",, drop=F]

Effort.TPpnPMABN <- function (thetas) thetas[,"mean_v.pnA3N",, drop=F] - thetas[,"mean_v.pnB3N",, drop=F]
Effort.TPpnPMBCN <- function (thetas) thetas[,"mean_v.pnB3N",, drop=F] - thetas[,"mean_v.pnC3N",, drop=F]
Effort.TPpnPMCDN <- function (thetas) thetas[,"mean_v.pnC3N",, drop=F] - thetas[,"mean_v.pnD3N",, drop=F]

Effort.TPpnPMABC <- function (thetas) thetas[,"mean_v.pnA3C",, drop=F] - thetas[,"mean_v.pnB3C",, drop=F]
Effort.TPpnPMBCC <- function (thetas) thetas[,"mean_v.pnB3C",, drop=F] - thetas[,"mean_v.pnC3C",, drop=F]
Effort.TPpnPMCDC <- function (thetas) thetas[,"mean_v.pnC3C",, drop=F] - thetas[,"mean_v.pnD3C",, drop=F]

Effort.TPpcPMABN <- function (thetas) thetas[,"mean_v.pcA3N",, drop=F] - thetas[,"mean_v.pcB3N",, drop=F]
Effort.TPpcPMBCN <- function (thetas) thetas[,"mean_v.pcB3N",, drop=F] - thetas[,"mean_v.pcC3N",, drop=F]
Effort.TPpcPMCDN <- function (thetas) thetas[,"mean_v.pcC3N",, drop=F] - thetas[,"mean_v.pcD3N",, drop=F]

# # # t0 # # #

av.t0 <- function (thetas) (thetas[ ,"t0",, drop=F])

t0.Table <- mean.sd(samples.E1,av.t0)
rownames(t0.Table) <- "t0"
t0.Table

# # # sdv # # #

av.sdv.ccC <- function (thetas) (thetas[ ,"sd_v.ccC",, drop=F])
av.sdv.nnC <- function (thetas) (thetas[ ,"sd_v.nnC",, drop=F])
av.sdv.pcC <- function (thetas) (thetas[ ,"sd_v.pcC",, drop=F])
av.sdv.pnC <- function (thetas) (thetas[ ,"sd_v.pnC",, drop=F])

av.sdv.ccN <- function (thetas) (thetas[ ,"sd_v.ccN",, drop=F])
av.sdv.nnN <- function (thetas) (thetas[ ,"sd_v.nnN",, drop=F])
av.sdv.pcN <- function (thetas) (thetas[ ,"sd_v.pcN",, drop=F])
av.sdv.pnN <- function (thetas) (thetas[ ,"sd_v.pnN",, drop=F])

av.sdv.ppP <- function (thetas) (thetas[ ,"sd_v.ppP",, drop=F])

sdv.ccC <- mean.sd(samples.E1,av.sdv.ccC)
sdv.nnC <- mean.sd(samples.E1,av.sdv.nnC)
sdv.pcC <- mean.sd(samples.E1,av.sdv.pcC)
sdv.pnC <- mean.sd(samples.E1,av.sdv.pnC)

sdv.ccN <- mean.sd(samples.E1,av.sdv.ccN)
sdv.nnN <- mean.sd(samples.E1,av.sdv.nnN)
sdv.pcN <- mean.sd(samples.E1,av.sdv.pcN)
sdv.pnN <- mean.sd(samples.E1,av.sdv.pnN)

sdv.ppP <- mean.sd(samples.E1,av.sdv.ppP)

sdv.Table <- data.frame(rbind(sdv.ccC=sdv.ccC,
                              sdv.nnC=sdv.nnC,
                              sdv.pcC=sdv.pcC,
                              sdv.pnC=sdv.pnC,

                              sdv.ccN=sdv.ccN,
                              sdv.nnN=sdv.nnN,
                              sdv.pcN=sdv.pcN,
                              sdv.pnN=sdv.pnN,

                              sdv.ppP=sdv.ppP))
sdv.Table

# # # Thresholds Averaged over Condition # # #
#
av.B.2o <- function (thetas) (thetas[,"B.A2C",, drop=F] + thetas[,"B.B2C",, drop=F] +
                                  thetas[,"B.C2C",, drop=F] + thetas[,"B.D2C",, drop=F] +
                                  thetas[,"B.A2N",, drop=F] + thetas[,"B.B2N",, drop=F] +
                                  thetas[,"B.C2N",, drop=F] + thetas[,"B.D2N",, drop=F])/8

av.B.3o <- function (thetas) (thetas[,"B.A3C",, drop=F] + thetas[,"B.B3C",, drop=F] +
                                  thetas[,"B.C3C",, drop=F] + thetas[,"B.D3C",, drop=F] +
                                  thetas[,"B.A3N",, drop=F] + thetas[,"B.B3N",, drop=F] +
                                  thetas[,"B.C3N",, drop=F] + thetas[,"B.D3N",, drop=F])/8

av.B.2C <- function (thetas) (thetas[,"B.A2C",, drop=F] + thetas[,"B.B2C",, drop=F] +
                                  thetas[,"B.C2C",, drop=F] + thetas[,"B.D2C",, drop=F])/4

av.B.3C <- function (thetas) (thetas[,"B.A3C",, drop=F] + thetas[,"B.B3C",, drop=F] +
                                  thetas[,"B.C3C",, drop=F] + thetas[,"B.D3C",, drop=F])/4

av.B.2N <- function (thetas) (thetas[,"B.A2N",, drop=F] + thetas[,"B.B2N",, drop=F] +
                                  thetas[,"B.C2N",, drop=F] + thetas[,"B.D2N",, drop=F])/4

av.B.3N <- function (thetas) (thetas[,"B.A3N",, drop=F] + thetas[,"B.B3N",, drop=F] +
                                  thetas[,"B.C3N",, drop=F] + thetas[,"B.D3N",, drop=F])/4

av.B.3P <- function (thetas) (thetas[,"B.A3P",, drop=F] + thetas[,"B.B3P",, drop=F] + thetas[,"B.C3P",, drop=F] + thetas[,"B.D3P",, drop=F])/4

B.2o <- mean.sd(samples.E1,av.B.2o)
B.3o <- mean.sd(samples.E1,av.B.3o)
B.2C <- mean.sd(samples.E1,av.B.2C)
B.3C <- mean.sd(samples.E1,av.B.3C)
B.2N <- mean.sd(samples.E1,av.B.2N)
B.3N <- mean.sd(samples.E1,av.B.3N)
B.3P <- mean.sd(samples.E1,av.B.3P)

av.Bs.PM.Table <- data.frame(rbind(B.2_Ongoing=B.2o,
                                   B.3_Ongoing=B.3o,
                                   B.2_Conflict=B.2C,
                                   B.3_Conflict=B.3C,
                                   B.2_Nonconflict=B.2N,
                                   B.3_Nonconflict=B.3N,
                                   B.3_PM=B.3P))
av.Bs.PM.Table$PM_Block <- NA;
av.Bs.PM.Table <- av.Bs.PM.Table[ ,c("PM_Block", "M", "SD")]
av.Bs.PM.Table$PM_Block[grep ("2", rownames(av.Bs.PM.Table))] <- "Control"; av.Bs.PM.Table$PM_Block[grep ("3", rownames(av.Bs.PM.Table))] <- "PM"
av.Bs.PM.Table

# # # Thresholds Averaged over PM Block # # #
#
av.B.Ao <- function (thetas) (thetas[,"B.A2C",, drop=F] + thetas[,"B.A3C",, drop=F] +
                                 thetas[,"B.A2N",, drop=F] + thetas[,"B.A3N",, drop=F])/4
av.B.Bo <- function (thetas) (thetas[,"B.B2C",, drop=F] + thetas[,"B.B3C",, drop=F] +
                                 thetas[,"B.B2N",, drop=F] + thetas[,"B.B3N",, drop=F])/4
av.B.Co <- function (thetas) (thetas[,"B.C2C",, drop=F] + thetas[,"B.C3C",, drop=F] +
                                 thetas[,"B.C2N",, drop=F] + thetas[,"B.C3N",, drop=F])/4
av.B.Do <- function (thetas) (thetas[,"B.D2C",, drop=F] + thetas[,"B.D3C",, drop=F] +
                                 thetas[,"B.D2N",, drop=F] + thetas[,"B.D3N",, drop=F])/4

av.B.AP <- function (thetas) thetas[,"B.A3P",, drop=F]
av.B.BP <- function (thetas) thetas[,"B.B3P",, drop=F]
av.B.CP <- function (thetas) thetas[,"B.C3P",, drop=F]
av.B.DP <- function (thetas) thetas[,"B.D3P",, drop=F]

B.Ao <- mean.sd(samples.E1,av.B.Ao)
B.Bo <- mean.sd(samples.E1,av.B.Bo)
B.Co <- mean.sd(samples.E1,av.B.Co)
B.Do <- mean.sd(samples.E1,av.B.Do)

B.AP <- mean.sd(samples.E1,av.B.AP)
B.BP <- mean.sd(samples.E1,av.B.BP)
B.CP <- mean.sd(samples.E1,av.B.CP)
B.DP <- mean.sd(samples.E1,av.B.DP)

av.Bs.TP.Table <- data.frame(rbind(B.A_Ongoing=B.Ao,
                                   B.B_Ongoing=B.Bo,
                                   B.C_Ongoing=B.Co,
                                   B.D_Ongoing=B.Do,

                                   B.A_PM=B.AP,
                                   B.B_PM=B.BP,
                                   B.C_PM=B.CP,
                                   B.D_PM=B.DP))
av.Bs.TP.Table$Time_Pressure <- NA;
av.Bs.TP.Table <- av.Bs.TP.Table[ ,c("Time_Pressure", "M", "SD")]
av.Bs.TP.Table$Time_Pressure[grep ("\\.A", rownames(av.Bs.TP.Table))] <- "A";
av.Bs.TP.Table$Time_Pressure[grep ("\\.B", rownames(av.Bs.TP.Table))] <- "B";
av.Bs.TP.Table$Time_Pressure[grep ("\\.C", rownames(av.Bs.TP.Table))] <- "C";
av.Bs.TP.Table$Time_Pressure[grep ("\\.D", rownames(av.Bs.TP.Table))] <- "D"
av.Bs.TP.Table


# # # Rates (Correct) Averaged over Condition # # #
#
av.v.cc2o <- function (thetas) (thetas[,"mean_v.ccA2C",, drop=F] + thetas[,"mean_v.ccB2C",, drop=F] +
                                    thetas[,"mean_v.ccC2C",, drop=F] + thetas[,"mean_v.ccD2C",, drop=F] +
                                    thetas[,"mean_v.nnA2N",, drop=F] + thetas[,"mean_v.nnB2N",, drop=F] +
                                    thetas[,"mean_v.nnC2N",, drop=F] + thetas[,"mean_v.nnD2N",, drop=F])/8
av.v.cc3o <- function (thetas) (thetas[,"mean_v.ccA3C",, drop=F] + thetas[,"mean_v.ccB3C",, drop=F] +
                                    thetas[,"mean_v.ccC3C",, drop=F] + thetas[,"mean_v.ccD3C",, drop=F] +
                                    thetas[,"mean_v.nnA3N",, drop=F] + thetas[,"mean_v.nnB3N",, drop=F] +
                                    thetas[,"mean_v.nnC3N",, drop=F] + thetas[,"mean_v.nnD3N",, drop=F])/8

av.v.cc2C <- function (thetas) (thetas[,"mean_v.ccA2C",, drop=F] + thetas[,"mean_v.ccB2C",, drop=F] +
                                    thetas[,"mean_v.ccC2C",, drop=F] + thetas[,"mean_v.ccD2C",, drop=F])/4
av.v.cc3C <- function (thetas) (thetas[,"mean_v.ccA3C",, drop=F] + thetas[,"mean_v.ccB3C",, drop=F] +
                                    thetas[,"mean_v.ccC3C",, drop=F] + thetas[,"mean_v.ccD3C",, drop=F])/4
av.v.pc3C <- function (thetas) (thetas[,"mean_v.pcA3C",, drop=F] + thetas[,"mean_v.pcB3C",, drop=F] +
                                    thetas[,"mean_v.pcC3C",, drop=F] + thetas[,"mean_v.pcD3C",, drop=F])/4

av.v.nn2C <- function (thetas) (thetas[,"mean_v.nnA2C",, drop=F] + thetas[,"mean_v.nnB2C",, drop=F] +
                                    thetas[,"mean_v.nnC2C",, drop=F] + thetas[,"mean_v.nnD2C",, drop=F])/4
av.v.nn3C <- function (thetas) (thetas[,"mean_v.nnA3C",, drop=F] + thetas[,"mean_v.nnB3C",, drop=F] +
                                    thetas[,"mean_v.nnC3C",, drop=F] + thetas[,"mean_v.nnD3C",, drop=F])/4
av.v.pn3C <- function (thetas) (thetas[,"mean_v.pnA3C",, drop=F] + thetas[,"mean_v.pnB3C",, drop=F] +
                                    thetas[,"mean_v.pnC3C",, drop=F] + thetas[,"mean_v.pnD3C",, drop=F])/4

av.v.nn2N <- function (thetas) (thetas[,"mean_v.nnA2N",, drop=F] + thetas[,"mean_v.nnB2N",, drop=F] +
                                    thetas[,"mean_v.nnC2N",, drop=F] + thetas[,"mean_v.nnD2N",, drop=F])/4
av.v.nn3N <- function (thetas) (thetas[,"mean_v.nnA3N",, drop=F] + thetas[,"mean_v.nnB3N",, drop=F] +
                                    thetas[,"mean_v.nnC3N",, drop=F] + thetas[,"mean_v.nnD3N",, drop=F])/4
av.v.pn3N <- function (thetas) (thetas[,"mean_v.pnA3N",, drop=F] + thetas[,"mean_v.pnB3N",, drop=F] +
                                    thetas[,"mean_v.pnC3N",, drop=F] + thetas[,"mean_v.pnD3N",, drop=F])/4

av.v.cc2N <- function (thetas) (thetas[,"mean_v.ccA2N",, drop=F] + thetas[,"mean_v.ccB2N",, drop=F] +
                                    thetas[,"mean_v.ccC2N",, drop=F] + thetas[,"mean_v.ccD2N",, drop=F])/4
av.v.cc3N <- function (thetas) (thetas[,"mean_v.ccA3N",, drop=F] + thetas[,"mean_v.ccB3N",, drop=F] +
                                    thetas[,"mean_v.ccC3N",, drop=F] + thetas[,"mean_v.ccD3N",, drop=F])/4
av.v.pc3N <- function (thetas) (thetas[,"mean_v.pcA3N",, drop=F] + thetas[,"mean_v.pcB3N",, drop=F] +
                                    thetas[,"mean_v.pcC3N",, drop=F] + thetas[,"mean_v.pcD3N",, drop=F])/4

av.v.pp3P <- function (thetas) (thetas[,"mean_v.ppA3P",, drop=F] + thetas[,"mean_v.ppB3P",, drop=F] +
                                    thetas[,"mean_v.ppC3P",, drop=F] + thetas[,"mean_v.ppD3P",, drop=F])/4


v.cc2o <- mean.sd(samples.E1,av.v.cc2o)
v.cc3o <- mean.sd(samples.E1,av.v.cc3o)

v.cc2C <- mean.sd(samples.E1,av.v.cc2C)
v.cc3C <- mean.sd(samples.E1,av.v.cc3C)
v.pc3C <- mean.sd(samples.E1,av.v.pc3C)

v.nn2C <- mean.sd(samples.E1,av.v.nn2C)
v.nn3C <- mean.sd(samples.E1,av.v.nn3C)
v.pn3C <- mean.sd(samples.E1,av.v.pn3C)

v.nn2N <- mean.sd(samples.E1,av.v.nn2N)
v.nn3N <- mean.sd(samples.E1,av.v.nn3N)
v.pn3N <- mean.sd(samples.E1,av.v.pn3N)

v.cc2N <- mean.sd(samples.E1,av.v.cc2N)
v.cc3N <- mean.sd(samples.E1,av.v.cc3N)
v.pc3N <- mean.sd(samples.E1,av.v.pc3N)

v.pp3P <- mean.sd(samples.E1,av.v.pp3P)

av.vs.PM.Table <- data.frame(rbind(v.cc2_Ongoing=v.cc2o,
                                   v.cc3_Ongoing=v.cc3o,

                                   v.cc2_Conflict=v.cc2C,
                                   v.cc3_Conflict=v.cc3C,
                                   v.pc3_Conflict_RC =v.pc3C,

                                   v.nn2_Conflict=v.nn2C,
                                   v.nn3_Conflict=v.nn3C,
                                   v.pn3_Conflict_RC=v.pn3C,

                                   v.nn2_Nonconflict=v.nn2N,
                                   v.nn3_Nonconflict=v.nn3N,
                                   v.pn3_Nonconflict_RC =v.pn3N,

                                   v.cc2_Nonconflict=v.cc2N,
                                   v.cc3_Nonconflict=v.cc3N,
                                   v.pc3_Nonconflict_RC =v.pc3N,

                                   v.pp3_PM=v.pp3P))
av.vs.PM.Table$PM_Block <- NA;
av.vs.PM.Table <- av.vs.PM.Table[ ,c("PM_Block", "M", "SD")]
av.vs.PM.Table$PM_Block[grep ("2", rownames(av.vs.PM.Table))] <- "Control"; av.vs.PM.Table$PM_Block[grep ("3", rownames(av.vs.PM.Table))] <- "PM"
av.vs.PM.Table


# # # Z-score and P-value Tables # # #
#
Reactive.Table <- data.frame(rbind(
    A.NonPM.minus.PM=c(zandp(samples.E1, Reactive.ccAC),
        zandp(samples.E1, Reactive.nnAN),
        zandp(samples.E1, Reactive.nnAC),
        zandp(samples.E1, Reactive.ccAN)
        ),

    B.NonPM.minus.PM=c(zandp(samples.E1, Reactive.ccBC),
        zandp(samples.E1, Reactive.nnBN),
        zandp(samples.E1, Reactive.nnBC),
        zandp(samples.E1, Reactive.ccBN)
        ),

    C.NonPM.minus.PM=c(zandp(samples.E1, Reactive.ccCC),
        zandp(samples.E1, Reactive.nnCN),
        zandp(samples.E1, Reactive.nnCC),
        zandp(samples.E1, Reactive.ccCN)
        ),

    D.NonPM.minus.PM=c(zandp(samples.E1, Reactive.ccDC),
        zandp(samples.E1, Reactive.nnDN),
        zandp(samples.E1, Reactive.nnDC),
        zandp(samples.E1, Reactive.ccDN)
        )
))
colnames(Reactive.Table) <- c("Conflict","Nonconflict","Conflict (Error)","Nonconflict (Error)")
# Reactive.Table

#
Proactive.Table <- data.frame(rbind(
    A.PM.minus.Control=c(zandp(samples.E1, Proactive.AC),
        zandp(samples.E1, Proactive.AN)
    ),

    B.PM.minus.Control=c(zandp(samples.E1, Proactive.BC),
        zandp(samples.E1, Proactive.BN)
    ),

    C.PM.minus.Control=c(zandp(samples.E1, Proactive.CC),
        zandp(samples.E1, Proactive.CN)
    ),

    D.PM.minus.Control=c(zandp(samples.E1, Proactive.DC),
        zandp(samples.E1, Proactive.DN)
    )
))
colnames(Proactive.Table) <- c("Conflict","Nonconflict")
# Proactive.Table

#
Capacity.Table <- data.frame(rbind(
    A.PM.minus.Control=c(zandp(samples.E1, Capacity.ccAC),
                         zandp(samples.E1, Capacity.nnAN),
                         zandp(samples.E1, Capacity.nnAC),
                         zandp(samples.E1, Capacity.ccAN)
    ),

    B.PM.minus.Control=c(zandp(samples.E1, Capacity.ccBC),
                         zandp(samples.E1, Capacity.nnBN),
                         zandp(samples.E1, Capacity.nnBC),
                         zandp(samples.E1, Capacity.ccBN)
    ),

    C.PM.minus.Control=c(zandp(samples.E1, Capacity.ccCC),
                         zandp(samples.E1, Capacity.nnCN),
                         zandp(samples.E1, Capacity.nnCC),
                         zandp(samples.E1, Capacity.ccCN)
    ),

    D.PM.minus.Control=c(zandp(samples.E1, Capacity.ccDC),
                         zandp(samples.E1, Capacity.nnDN),
                         zandp(samples.E1, Capacity.nnDC),
                         zandp(samples.E1, Capacity.ccDN)
    )
))
colnames(Capacity.Table) <- c("Conflict","Nonconflict","Conflict (Error)","Nonconflict (Error)")
# Capacity.Table

#
ProactiveTP.Table <- data.frame(rbind(
    PM.Cost.A.minus.B=c(zandp(samples.E1, ProactiveTP.ABC),zandp(samples.E1, ProactiveTP.ABN)
    ),

    PM.Cost.B.minus.C=c(zandp(samples.E1, ProactiveTP.BCC),zandp(samples.E1, ProactiveTP.BCN)
    ),

    PM.Cost.C.minus.D=c(zandp(samples.E1, ProactiveTP.CDC),zandp(samples.E1, ProactiveTP.CDN)
    )
))
colnames(ProactiveTP.Table) <- c("Conflict","Nonconflict")
# ProactiveTP.Table

#
Effort.by.TP.Table.Wide <- data.frame(rbind(
    Conflict=c(zandp(samples.E1, Effort.TPccCABC),
               zandp(samples.E1, Effort.TPccCBCC),
               zandp(samples.E1, Effort.TPccCCDC),

               zandp(samples.E1, Effort.TPccPMABC),
               zandp(samples.E1, Effort.TPccPMBCC),
               zandp(samples.E1, Effort.TPccPMCDC)
    ),

    Nonconflict=c(zandp(samples.E1, Effort.TPnnCABN),
                  zandp(samples.E1, Effort.TPnnCBCN),
                  zandp(samples.E1, Effort.TPnnCCDN),

                  zandp(samples.E1, Effort.TPnnPMABN),
                  zandp(samples.E1, Effort.TPnnPMBCN),
                  zandp(samples.E1, Effort.TPnnPMCDN)
    ),

    Conflict.FA=c(zandp(samples.E1, Effort.TPnnCABC),
                  zandp(samples.E1, Effort.TPnnCBCC),
                  zandp(samples.E1, Effort.TPnnCCDC),

                  zandp(samples.E1, Effort.TPnnPMABC),
                  zandp(samples.E1, Effort.TPnnPMBCC),
                  zandp(samples.E1, Effort.TPnnPMCDC)
    ),

    Nonconflict.FA=c(zandp(samples.E1, Effort.TPccCABN),
                     zandp(samples.E1, Effort.TPccCBCN),
                     zandp(samples.E1, Effort.TPccCCDN),

                     zandp(samples.E1, Effort.TPccPMABN),
                     zandp(samples.E1, Effort.TPccPMBCN),
                     zandp(samples.E1, Effort.TPccPMCDN)
    ),
    PM.to.PM=c("-","-","-",
               zandp(samples.E1, Effort.TPppPMABP),
               zandp(samples.E1, Effort.TPppPMBCP),
               zandp(samples.E1, Effort.TPppPMCDP)
    ),
    Conflict.to.PMC=c("-","-","-",
                      zandp(samples.E1, Effort.TPpcPMABC),
                      zandp(samples.E1, Effort.TPpcPMBCC),
                      zandp(samples.E1, Effort.TPpcPMCDC)
    ),
    Nonconflict.to.PMN=c("-","-","-",
                         zandp(samples.E1, Effort.TPpnPMABN),
                         zandp(samples.E1, Effort.TPpnPMBCN),
                         zandp(samples.E1, Effort.TPpnPMCDN)
    ),
    Conflict.to.PMN=c("-","-","-",
                      zandp(samples.E1, Effort.TPpnPMABC),
                      zandp(samples.E1, Effort.TPpnPMBCC),
                      zandp(samples.E1, Effort.TPpnPMCDC)
    ),
    Nonconflict.to.PMC=c("-","-","-",
                         zandp(samples.E1, Effort.TPpcPMABN),
                         zandp(samples.E1, Effort.TPpcPMBCN),
                         zandp(samples.E1, Effort.TPpcPMCDN)
    )
))
colnames(Effort.by.TP.Table.Wide) <- c("A-B (Control)","B-C (Control)","C-D (Control)","A-B (PM)","B-C (PM)","C-D (PM)")


# # # Tables # # #
t0.Table
sdv.Table
av.Bs.PM.Table
av.Bs.TP.Table
av.vs.PM.Table

Reactive.Table
Proactive.Table
Capacity.Table
ProactiveTP.Table
Effort.by.TP.Table.Wide

```

## Parameter Table: Nondecision Time

```{r t0, echo=FALSE}

panderOptions("digits", 3)

table <- t0.Table

pander(table)

```

## Parameter Table: sdv

```{r sdv, echo=FALSE}

panderOptions("digits", 3)

table <- sdv.Table

pander(table)

```


## Parameter Table: Thresholds by PM Block

```{r thresholds by pm block, echo=FALSE}

panderOptions("digits", 3)

table <- av.Bs.PM.Table

pander(table)

```

## Parameter Table: Thresholds by Time Pressure

```{r thresholds by time pressure, echo=FALSE}

panderOptions("digits", 3)

table <- av.Bs.TP.Table

pander(table)

```

## Parameter Table: Drift Rates by PM Block

```{r rates by pm block, echo=FALSE}

panderOptions("digits", 3)

table <- av.vs.PM.Table

pander(table)

```

## Posterior Inference Table: Reactive Inhibition

```{r post inf reactive inhibition, echo=FALSE}

panderOptions("digits", 3)

table <- Reactive.Table

pander(table)

```

## Posterior Inference Table: Proactive Control

```{r post inf proactive control pm, echo=FALSE}

panderOptions("digits", 3)

table <- Proactive.Table

pander(table)

```

## Posterior Inference Table: Capacity Sharing

```{r post inf capacity sharing, echo=FALSE}

panderOptions("digits", 3)

table <- Capacity.Table

pander(table)

```

## Posterior Inference Table: Proactive Control by Time Pressure

```{r post inf proactive control time pressure, echo=FALSE}

panderOptions("digits", 3)

table <- ProactiveTP.Table

pander(table)

```

## Posterior Inference Table: Effort/Arousal by Time Pressure

```{r post inf effort arousal time pressure, echo=FALSE}

panderOptions("digits", 3)

table <- Effort.by.TP.Table.Wide

pander(table)

```
